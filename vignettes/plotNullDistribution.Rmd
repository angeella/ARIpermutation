---
title: "Plot simulate data"
author: "Angela Andreella"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{toy}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(ARIpermutation)
```

```{r}
m <- 1e4 #number of variables
n <- 1e2 #number of observations
B = 1000
SNR = 5
pi0 = 0.9
rho = 0.4
```


Create simulate data 

```{r}
sim <- sansSouci::gaussianSamples(m, rho, n, pi0, SNR = SNR, prob = 1)
X <- sim$X #rows represent variables
out <- ARIpermutation::signTest(X,B)
P <- t(cbind(out$pv, out$pv_H0))
```

So, we plot the null distribution

```{r}
ARIpermutation::plotNullDistribution(P = P)
```

We add the Simes critical values:

```{r}
ARIpermutation::plotNullDistribution(P = P ,family="Finner",alpha = 0.1, ct = c(0,1), delta = 0)
```

```{r}
ARIpermutation::plotNullDistribution(P = P ,family="Finner",alpha = 0.1, ct = c(0,1), delta = 7)
```


